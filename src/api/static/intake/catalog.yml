metadata:
  version: 1
  parameters:
    shot:
      description: shot number to load from the campaign.
      type: int
sources:
  db:
    driver: intake.catalog.local.YAMLFileCatalog
    args:
      path: "{{CATALOG_DIR}}/db.yml"
  shots:
    driver: intake_xarray.xzarr.ZarrSource
    description: "Shot data from the MAST tokamak"
    parameters:
      url:
        description: URL location of the shot in the s3 bucket. e.g. "s3://mast/level1/30420.zarr"
        type: str
      group:
        description: Name of the source group within the shot to open. e.g. "amc"
        type: str
        default: ""
      cache_type:
        description: Type of caching to use with s3. Defaults to "simplecache"
        type: str
        default: "simplecache"
      cache_dir:
        description: Location to cache remote data locally.
        type: str
        default: "/tmp"
    args:
      urlpath: "{{cache_type}}::{{url}}/{{group}}"
      consolidated: True
      storage_options:
        s3:
          anon: true
          endpoint_url: "https://s3.echo.stfc.ac.uk"
        cache_storage: "{{cache_dir}}"